:root {
   --bg-color: #2b2b2b;
   --panel-bg: #383838;
   --accent: #5c87ff;
   --text: #e0e0e0;
   --border: #555;
   --success: #28a745;
   --warning: #ffc107;
}
* { box-sizing: border-box; }
body {
   font-family: 'Segoe UI', sans-serif;
   background-color: var(--bg-color);
   color: var(--text);
   display: flex;
   height: 100vh;
   height: 100dvh;
   width: 100vw;
   margin: 0;
   overflow: hidden;
   user-select: none;
   overscroll-behavior: none;
}
/* --- DESKTOP LAYOUT --- */
.sidebar {
   width: 280px;
   background-color: var(--panel-bg);
   padding: 15px;
   display: flex;
   flex-direction: column;
   gap: 15px;
   border-right: 1px solid var(--border);
   overflow-y: auto;
   flex-shrink: 0;
   z-index: 10;
}
.main-area {
   flex: 1;
   display: flex;
   flex-direction: column;
   justify-content: center;
   align-items: center;
   position: relative;
   background-image:
       linear-gradient(45deg, #222 25%, transparent 25%),
       linear-gradient(-45deg, #222 25%, transparent 25%),
       linear-gradient(45deg, transparent 75%, #222 75%),
       linear-gradient(-45deg, transparent 75%, #222 75%);
   background-size: 20px 20px;
   background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
   overflow: hidden;
   gap: 20px;
   touch-action: none;
}
/* --- MOBILE LAYOUT --- */
@media (max-width: 768px) {
   body { flex-direction: column; }
   .sidebar {
       width: 100%;
       height: 45%;
       order: 2;    
       border-right: none;
       border-top: 4px solid var(--accent);
       padding: 10px;
       gap: 10px;
       box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
   }
   .main-area {
       width: 100%;
       height: 55%;
       order: 1;    
       gap: 0;      
       background-size: 10px 10px;
   }
   .app-title { display: none; }
   button { padding: 12px; font-size: 1em; }
   .swatch { height: 45px; }
}
/* --- COMPONENTS --- */
.app-title {
   margin: 0 0 5px 0;
   font-size: 1.4em;
   color: #fff;
   text-align: center;
   font-weight: 800;
   text-transform: uppercase;
   letter-spacing: 1px;
   background: rgba(0,0,0,0.2);
   padding: 10px;
   border-radius: 6px;
   border: 1px solid var(--border);
   text-shadow: 2px 2px 0 #000;
}
h3 { margin-bottom: 8px; font-size: 1em; border-bottom: 1px solid #555; padding-bottom: 2px; color: #aaa; text-transform: uppercase; letter-spacing: 1px; }
.tool-group {
   display: flex;
   flex-wrap: wrap;
   gap: 5px;
   justify-content: center;
}
.tool-group button {
   flex: 1 0 18%; /* Flexible width */
   min-width: 35px;
}
button {
   background: #4a4a4a;
   border: 1px solid var(--border);
   color: white;
   padding: 8px;
   cursor: pointer;
   border-radius: 4px;
   font-size: 0.9em;
   transition: 0.2s;
   position: relative;
   touch-action: manipulation;
}
button:hover { background: #5a5a5a; }
button:active { transform: translateY(1px); }
button.active {
   background: var(--accent);
   border-color: #7aa0ff;
}
.brush-control {
   display: flex;
   align-items: center;
   gap: 10px;
   margin-top: 10px;
   background: rgba(0,0,0,0.2);
   padding: 8px;
   border-radius: 4px;
}
.import-box {
   background: rgba(0,0,0,0.2);
   padding: 10px;
   border-radius: 4px;
   border: 1px dashed #666;
   text-align: center;
}
.btn-search {
   background: var(--warning);
   color: #222;
   font-weight: bold;
   border: none;
   width: 100%;
   margin-bottom: 5px;
   display: block;
   text-align: center;
   text-decoration: none;
   padding: 8px 0;
   border-radius: 4px;
   font-size: 0.9em;
   box-sizing: border-box;
}
.color-controls { display: flex; flex-direction: column; gap: 8px; }
.current-color-row { display: flex; gap: 8px; align-items: center; }
#drag-source {
   width: 40px; height: 40px; border: 2px solid white; border-radius: 4px; cursor: grab;
   box-shadow: 0 2px 5px rgba(0,0,0,0.5);
   flex-shrink: 0;
}
.input-group { flex: 1; display: flex; flex-direction: column; gap: 2px; width: 100%; }
input[type="color"] { width: 100%; height: 25px; border: none; cursor: pointer; background: none; padding: 0; }
input[type="text"] {
   background: #222; border: 1px solid var(--border); color: white;
   padding: 4px; border-radius: 4px; text-transform: uppercase; font-family: monospace;
   width: 100%; box-sizing: border-box;
}
.palette {
   display: grid;
   grid-template-columns: repeat(4, 1fr);
   gap: 8px;
   margin-top: 10px;
   padding: 5px;
   background: rgba(0,0,0,0.1);
   border-radius: 4px;
   max-height: 160px;
   overflow-y: auto;
   scrollbar-width: thin;
   scrollbar-color: #555 #2b2b2b;
}
.palette::-webkit-scrollbar { width: 6px; }
.palette::-webkit-scrollbar-track { background: #2b2b2b; }
.palette::-webkit-scrollbar-thumb { background: #555; border-radius: 3px; }
.swatch {
   height: 35px; border-radius: 4px; border: 1px solid var(--border); cursor: pointer; transition: transform 0.1s;
}
.swatch.drag-over { border: 2px dashed white; opacity: 0.5; }
.btn-add-color {
   height: 35px;
   border: 2px dashed #555;
   border-radius: 4px;
   background: rgba(255,255,255,0.05);
   color: #888;
   font-weight: bold;
   font-size: 1.2em;
   display: flex;
   align-items: center;
   justify-content: center;
   cursor: pointer;
   transition: 0.2s;
}
.btn-add-color:hover {
   border-color: var(--accent);
   color: white;
   background: rgba(255,255,255,0.1);
}
canvas {
   image-rendering: pixelated;
   box-shadow: 0 0 20px rgba(0,0,0,0.5);
   background: white;
   cursor: none;
   max-width: 95%;
   max-height: 95%;
   touch-action: none;
}
.preview-box {
   background: #222; border: 1px solid var(--border); padding: 10px; text-align: center; border-radius: 4px;
}
.frame-list {
   display: flex; gap: 5px; overflow-x: auto; padding-bottom: 5px; min-height: 44px;
}
.frame-thumb {
   width: 40px; height: 40px; border: 2px solid var(--border); image-rendering: pixelated;
   background: #fff; flex-shrink: 0; cursor: pointer;
}
.frame-thumb.selected { border-color: var(--accent); }
.control-row { display: flex; justify-content: space-between; align-items: center; font-size: 0.85em; }
input[type="number"] { width: 50px; background: #222; border: 1px solid var(--border); color: white; padding: 4px; border-radius: 4px; }
#file-input { display: none; }
#paste-overlay {
   position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(92, 135, 255, 0.8);
   display: none; justify-content: center; align-items: center; color: white; font-size: 2em;
   font-weight: bold; pointer-events: none; z-index: 100;
}
#autosave-indicator {
   position: fixed; top: 10px; right: 10px; background: rgba(40, 167, 69, 0.9); color: white;
   padding: 5px 10px; border-radius: 4px; font-size: 0.8em; opacity: 0; pointer-events: none; transition: opacity 0.5s;
   z-index: 1000; box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}